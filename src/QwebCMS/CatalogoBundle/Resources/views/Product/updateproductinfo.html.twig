{# src/Acme/DemoBundle/Resources/views/Random/index.html.twig #}
{% extends '::layout.html.twig' %}
{% block title %}Modifica {{ product.title }}{% endblock %}
{% block stylesheets %}
    <link href="{{ asset('admin-style/css/plugins/switchery/switchery.css') }}" rel="stylesheet">
    <link href="{{ asset('admin-style/css/plugins/chosen/chosen.css') }}" rel="stylesheet">
{% endblock %}

{% block pagetitle %}
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-12">
        <h2>Modifica "{{ product.title }}"</h2>
        <h4>Categoria:</h4>
        {% for category in categories %}
            <span>{{ category.title }}</span>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block menu %}
    <li class="active">
        <a href="/"><i class="fa fa-th-large"></i> <span class="nav-label">Catalogo</span> <span class="fa arrow"></span></a>
        <ul class="nav nav-second-level collapse in">
            <li><a href="{{ path('welcome') }}">Dashboard</a></li>
            <li class="active">
                <a href="{{ path('products') }}">Prodotti <span class="fa arrow"></span></a>
                <ul class="nav nav-third-level collapse">
                    {% for category in categories %}
                        <li><a href="{{ path('show_category', {id : category.idTblCatalogueCategory}) }}">{{ category.title }}</a></li>
                    {% endfor %}
                </ul>
            </li>
            <li><a href="{{ path('categories') }}">Categorie</a></li>
            <li><a href="{{ path('features') }}">Caratteristiche</a></li>
        </ul>
    </li>
{% endblock %}

{% block content %}

    <div class="wrapper wrapper-content animated fadeInRight ecommerce">
        {{ form_start(form) }}

        <div class="row">
            <div class="col-lg-12">
                <div class="tabs-container">
                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="">Informazioni Prodotto</a></li>
                        <li class=""><a href="{{ path('update_product_feature', {id : product.idTblCatalogueProduct}) }}">Caratteristiche</a></li>
                        <li class=""><a href="{{ path('update_product_immagini', {id : product.idTblCatalogueProduct}) }}">Immagini</a></li>
                    </ul>
                    <div class="tab-content">

                        <div id="tab-1" class="tab-pane active">
                            <div class="panel-body">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        {{ form_label(form.categories, 'Categoria'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.categories) }}
                                        <div class="input-group" style="width:100%;">
                                            {{ form_widget(form.categories, {'attr': {'class': 'chosen-select', 'data-placeholder':'Scegli una categoria'}}) }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            {{ form_label(form.pub, 'Pubblica'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                            {{ form_errors(form.pub) }}
                                            <div>
                                                {{ form_widget(form.pub, { 'attr': {'class': 'js-switch'} }) }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            {{ form_label(form.featured, 'Visibile in Homepage'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                            {{ form_errors(form.featured) }}
                                            <div>
                                                {{ form_widget(form.featured, { 'attr': {'class': 'js-switch'} }) }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        {{ form_label(form.title, 'Titolo / Nome immobile'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.title) }}
                                        {{ form_widget(form.title, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                    <div class="form-group">
                                        {{ form_label(form.shortDescription, 'Breve Descrizione'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.shortDescription) }}
                                        {{ form_widget(form.shortDescription, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                    <div class="form-group">
                                        {{ form_label(form.description, 'Descrizione Completa Immobile'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.description) }}
                                        {{ form_widget(form.description, {'attr': {'class': 'form-control tinymce'}}) }}
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        {{ form_label(form.indirizzo, 'Indirizzo'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.indirizzo) }}
                                        {{ form_widget(form.indirizzo, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        {{ form_label(form.coordinate, 'Coordinate'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.coordinate) }}
                                        {{ form_widget(form.coordinate, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.comfort, 'Comfort'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.comfort) }}
                                        {{ form_widget(form.comfort, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.accessori, 'Accessori'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.accessori) }}
                                        {{ form_widget(form.accessori, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.parcheggio, 'Parcheggio'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.parcheggio) }}
                                        {{ form_widget(form.parcheggio, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.classeEnergetica, 'Classe Energetica'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.classeEnergetica) }}
                                        {{ form_widget(form.classeEnergetica, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.prezzo, 'Prezzo'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.prezzo) }}
                                        {{ form_widget(form.prezzo, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.valoreCatastale, 'Valore Catastale'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.valoreCatastale) }}
                                        {{ form_widget(form.valoreCatastale, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.cod, 'Codice'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.cod) }}
                                        {{ form_widget(form.cod, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.position, 'Posizione'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.position) }}
                                        {{ form_widget(form.position, {'attr': {'class': 'form-control'}}) }}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        {{ form_label(form.download, 'download'|default(null) ,{'label_attr': {'class': 'control-label'}}) }}
                                        {{ form_errors(form.download) }}
                                        {{ form_widget(form.download, {'attr': {'class': 'form-control'}}) }}
                                        <div id="drop-download" class="dropzone col-lg-12" style="width:100%; min-height: 38px !important; padding: 8px !important;" action="#">
                                            <div class="dropzone-previews"></div>
                                            <div class="dz-message">Carica <strong>download</strong></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-12">
                            {{ form_label(form.saveAndContinue, label|default(null) ,{'label_attr': {'class': 'control-label col-sm-12'}}) }}
                            {{ form_widget(form.saveAndContinue, {'attr': {'class': 'btn btn-primary'}}) }}

                            {{ form_label(form.save, label|default(null) ,{'label_attr': {'class': 'control-label col-sm-12'}}) }}
                            {{ form_widget(form.save, {'attr': {'class': 'btn btn-primary'}}) }}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {{ form_end(form) }}

    </div>


{% endblock %}

{% block javascripts %}
    <!-- Switchery -->
    <script src="{{ asset('admin-style/js/plugins/switchery/switchery.js') }}"></script>

    <!-- Chosen -->
    <script src="{{ asset('admin-style/js/plugins/chosen/chosen.jquery.js') }}"></script>

    <!-- DROPZONE -->
    <script src="{{ asset('admin-style/js/plugins/dropzone/dropzone.js') }}"></script>

    <script>
        $(document).ready(function(){
            var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));
            elems.forEach(function(html) {
                var switchery = new Switchery(html);
            });
            //var switchery = new Switchery(elem, { color: '#1AB394' });

            var config = {
                '.chosen-select'           : {},
                '.chosen-select-deselect'  : {allow_single_deselect:true},
                '.chosen-select-no-single' : {disable_search_threshold:10},
                '.chosen-select-no-results': {no_results_text:'Oops, nessun elemento trovato!'},
                '.chosen-select'           : {width:"95%"}
            }
            for (var selector in config) {
                $(selector).chosen(config[selector]);
            }

            Dropzone.options.dropdownload = {

                url: "{{ oneup_uploader_endpoint('planimetrie') }}",
                autoProcessQueue: true,
                //uploadMultiple: true,
                parallelUploads: 1,
                maxFiles: 1,
                acceptedFiles: 'image/*,application/pdf',
                addRemoveLinks: true,
                headers:{"id-product": "{{ product.idTblCatalogueProduct }}"},

                // Dropzone settings
                init: function() {
                    var dropdownloadObject = this;
                    dropdownloadObject.on("sendingmultiple", function() {
                    });
                    dropdownloadObject.on("successmultiple", function(files, response) {
                    });
                    dropdownloadObject.on("errormultiple", function(files, response) {
                    });
                    dropdownloadObject.on("queuecomplete", function(files, response) {
                        //setTimeout("location.reload(true);", 1000);
                    });
                }

            }
        });
    </script>
    {{ tinymce_init() }}
{% endblock %}
